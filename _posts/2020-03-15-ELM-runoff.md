---
layout: post
title: About ELM/CLM runoff variables
date: 2020-03-15 15:19
author: Tian
comments: true
categories: [E3SM, Programming]
tags: Null
---
There are many variables related to runoff generated in ELM/CLM. These fluxes are then passed to MOSART with different names, need to be very clear what do they mean.

The hydrologic processes for CLM 4.5 are clearly represented below. I got it from Gautam but don't know if he made it. (more [here](https://escomp.github.io/ctsm-docs/versions/master/html/tech_note/Hydrology/CLM50_Tech_Note_Hydrology.html) for CLM 5). 

![CLM  hydrology](../../../../../../images/CLM45_hydrology.jpg)

Basically, the runoff generated by ELM has three parts: 1) surface runoff, 2) subsurface runoff, and 3) glacier, wetland, and lakes (GWL) for water balance. 

1) Surface runoff is `qflx_surf` + `qflx_h2osfc_surf` at column level or `qflx_rofliq_qsur_grc` + `qflx_rofliq_qsurp_grc` at grid level. The first term is called "surface runoff", which is excess water from soil saturation (`QOVER` in ELM output); the second term is called surface water runoff, which is the outflow from surface water storage such as pond (`QH2OSFC` in ELM output). It is very confusing by looking at the two names in the output.

2) Subsurface runoff is `qflx_drain` + `qflx_qflx_drain_perched` at column level or `qflx_rofliq_qsub_grc` + `qflx_rofliq_qsubp_grc` at grid level. The first term is called "sub-surface drainage" (`QDRAI` in ELM output); the second term is called "perched wt drainage" (`QDRAI_PERCH` in ELM output). These two terms are pretty straightforward. 

3) GWL runoff is the glacier, wetland and lakes water balance residual component which is not routed in MOSART

The sum of the three terms is `QRUNOFF` in ELM output file. These three terms are passed to MOSART for routing and named `QSUR_LIQ`, `QSUB_LIQ`, and `QGWL_LIQ` in MOSART's output file. The fluxes that enters MOSART channels for routing in E3SM V1 are the sum of `QSUR_LIQ` and `QSUB_LIQ` where `QSUR_LIQ` = `ELM-QOVER`+`ELM-QH2OSFC`; `QSUB_LIQ` = `ELM-QDRAI`+`ELM-QDRAI_PERCH`.

### some other highlights/comments

- In default, irrigation is added directly on the ground, bypassing the canopy.
- There's a elevation standard deviation term (STD_ELEV) in ELM surface data to describe the microtopology in the grid, which is used to dynamically calculate the fraction of surface water storage (FH2OSFC) over the grid.
- CLM 4.5 history field names can be found [here](http://www.cesm.ucar.edu/models/cesm1.2/clm/models/lnd/clm/bld/namelist_files/history_fields_clm4_5.xml).
- In current hydrology scheme, there's a pre-defined term `qflx_flood` taking flood flux from the river model (RTM) and re-applied it on top of the soil, this can be re-activated when coupling ELM and MOSART in terms of flood inundation. Not sure if we can directly add inundated water into `H2OSFC` here.