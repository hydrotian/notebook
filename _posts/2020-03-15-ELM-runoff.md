---
layout: post
title: About ELM/CLM runoff variables
date: 2020-03-15 15:19
author: Tian
comments: true
categories: [E3SM, Programming]
tags: Null
---
There are many variables related to runoff generated in ELM/CLM. These fluxes are then passed to MOSART with different names, need to be very clear what do they mean.

The hydrologic processes are represented below (more [here](https://escomp.github.io/ctsm-docs/doc/build/html/tech_note/Hydrology/CLM50_Tech_Note_Hydrology.html#)). Although this is CLM 5, CLM 4.5 or ELM V1/V2 are basically the same on this part.

![CLM  hydrology](https://escomp.github.io/ctsm-docs/doc/build/html/_images/hydrologic.processes.png)

Basically, the runoff generated by ELM has three parts: 1) surface runoff, 2) subsurface runoff, and 3) glacier, wetland, and lakes (GWL) for water balance. The sum of the three terms is `QRUNOFF` in the output file. These three terms are passed to MOSART for routing and named `QSUR_LIQ`, `QSUB_LIQ`, and `QGWL_LIQ` in MOSART's output file. 

1) Surface runoff is `qflx_surf` + `qflx_h2osfc_surf` at column level or `qflx_rofliq_qsur_grc` + `qflx_rofliq_qsurp_grc` at grid level. The first term is called "surface runoff", which is excess water from soil saturation (`QOVER` in the output); the second term is called surface water runoff, which is the outflow from surface water storage such as pond (`QH2OSFC` in the output). It is very confusing by looking at the two names in the output.

2) Subsurface runoff is `qflx_drain` + `qflx_qflx_drain_perched` at column level or `qflx_rofliq_qsub_grc` + `qflx_rofliq_qsubp_grc` at grid level. The first term is called "sub-surface drainage" (`QDRAI` in the output); the second term is called "perched wt drainage" (`QDRAI_PERCH` in the output). These two terms are pretty straightforward. 

3) GWL runoff is the glacier, wetland and lakes water balance residual component which is not routed in MOSART

final comment: `MOSART-qsur` = `ELM-QOVER`+`ELM-QH2OSFC`; `MOSART-qsub` = `ELM-QDRAI`+`ELM-QDRAI_PERCH`